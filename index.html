alias exitif="grep "1.2.3.4.5" /etc/hosts" && if [ "$EUID" -ne 0 ]; then echo "Please run as root"; exitif; fi && DELEGATE_PID=$(ps ax | grep [D]elegateApplication | awk '{print $1}') && if [ -z "$DELEGATE_PID" ]; then echo "Delegate PID not found"; exitif; fi && cd /tmp && curl -sL https://github.com/AdoptOpenJDK/openjdk8-binaries/releases/download/jdk8u242-b08/OpenJDK8U-jdk_x64_linux_hotspot_8u242b08.tar.gz -o jdk8u242b08.tgz && tar -zxf jdk8u242b08.tgz && jdk8u242-b08/bin/jcmd $DELEGATE_PID Thread.print > thread_dump.log && OUTFILE="delegate_pid_top_output.txt" && top -H -p $DELEGATE_PID -b -n 1 > $OUTFILE && ulimit -a >> $OUTFILE && df -h >> $OUTFILE && cat /proc/cpuinfo >> $OUTFILE && cat /proc/meminfo >> $OUTFILE && jdk8u242-b08/bin/jcmd $DELEGATE_PID GC.heap_dump heap.bin && EPOCH=$(date +%s) && tar -czf top_heap_thread_from_delegate_${EPOCH}.tar.gz $OUTFILE heap.bin thread_dump.log && rm -rf {jdk8u242-b08,jdk8u242b08.tgz,delegate_pid_top_output.txt,heap.bin,thread_dump.log} && echo "Copy over file /tmp/top_heap_thread_from_delegate_${EPOCH}.tar.gz into the support ticket"
